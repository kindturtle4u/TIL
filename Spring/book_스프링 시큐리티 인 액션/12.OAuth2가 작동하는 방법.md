> 출처 : 스프링 시큐리티 인 액션 : 보안 기초부터 OAuth 2까지, 스프링 시큐리티를 활용한 안전한 앱 설계와 구현

# 12. OAuth2가 작동하는 방법
- OAuth2 프레임워크의 주요 구성 요소가 사용자, 클라이언트, 리소스 서버, 권한부여서버 임을 확인한다.

## 12.1 OAuth2 프레임워크
- OAuth2 를 권한 부여 프레임워크(또는 사양프레임워크)라고 부르는 경우가 많으며, 타사 웹사이트나 웹이 리소스에 접근할 수 있게 허용하는 거싱 주 목적이다.

## 12.2 OAuth2 인증 아키텍처의 구성 요소
- 리소스 서버: 사용자가 소유한 리소스를 호스팅하는 서버. 리소스는 사용자의 데이터이거나 사용자가 수행할 수 있는 작업일 수 있다.
- 사용자(또는 리소스 소유자): 리소스 서버가 노출하는 리소스를 소유하는 개인, 일반적으로 사용자는 사용자의 이름과 암호로 신원을 증명한다.
- 클라이언트 - 사용자를 대신해 사용자가 소유한 리소스에 접근하는 애플리케이션, 클라이언트는 클라이언트 ID와 클라이언트 비밀을 이용해 신원을 증명한다.
이러한 자격 증명은 사용자 자격 증명과는 다르다는데 주의하자. 클라이언트는 요청할때 자신을 증명하는 자체 자격 증명이 필요하다.
- 권한 부여 서버: 클라이언트가 리소스 서버가 노출하는 사용자의 리소스에 접근할 권한을 부여하는 애플리케이션. 권한 부여 서버는 클라이언트가 사용자 대신 리소스에 접근
권한이 있다고 결정하면 토큰을 발급한다. 클라이언트는 이 토큰을 이용해 권한 부여 서버에서 권한을 받았음을 리소스 서버에 증명한다. 리소스 서버는 유효한 토큰이 있으면
클라이언트가 요청한 리소스에 접근하게 허용한다.

## 12.3 OAuth2를 구현하는 방법 선택
- OAuth2를 이용한다는 것은 권한 부여에 토큰을 이용한다는 뜻이다. 토콘은 액세스 카드와 비슷
- OAuth2는 그랜트(grant)라고 하는 토큰을 얻는 여러 방법을 제공한다. 다음은 선택할 수 있는 가장 일반적인 OAuth2 그랜트 유형이다.
  * 승인 코드
  * 암호
  * 갱신 토큰
  * 클라이언트 자격 증명

### 12.3.1 승인 코드 그랜트 유형의 구현
- 1. 인증요청을 한다.
- 2. 액세스 토큰을 얻는다.
- 3. 보호된 리소스를 호출한다.

#### 1단계: 승인 코드 그랜트 유형으로 인증 요청 수행
#### 2단계: 승인 코드 그랜트 유형으로 액세스 토큰 얻기
#### 3단계: 승인 코드 그랜트 유형으로 보호된 리소스 호출

### 12.3.2 암호 그랜트 유형 구현

