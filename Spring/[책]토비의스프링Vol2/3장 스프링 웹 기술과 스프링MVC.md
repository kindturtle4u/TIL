> 출처 : 토비의 스프링 3.1 Vol. 2 읽으면서 정리

# 3장 스프링 웹 기술과 스프링 MVC
## 3.1 스프링의 웹 프레젠테이션 계층 기술
### 3.1.1 스프링에서 사용되는 웹 프레임워크의 종류
- 스프링 서블릿/스프링 MVC
- 스프링 포틀릿
- Spring Web Flow
- 스프링 서블릿을 기반으로 해서 상태 유지 스타일의 웹 어플리케이션을 작성하게 해주는 프레임워크
- Spring JavaScrpit
- 자바스크립트 툴킷인  Dojo를 추상화 한것.
- 스프링 서블릿과 스프링 웹 플로우에 연동해서 손십게 Ajax 기능을 구축할 수 있도록 만들어져 있다.
- Spring Faces
- JSF를 스프링 MVC와 스프링 SWF의 뷰로 손쉽게 하용할 수 있게 해주는 프레임워크
- Spring Web Service
- Spring BlazeDS Integration
- JSP/Servlet
- Struts1
- Struts2
- Tapestry3.4
- JSF/Seam

### 3.1.2 스프링 MVC와 DispacherServlet 전략
스프링을 사용하는 개발자는 스프링이 제공해준 MVC 프레임워크 위에 필요한 전략을 추가해서
사용할 수 있어야 한다.
      
#### 프론트 컨트롤러 패턴
중앙 집중형 컨트롤러를 프레젠테이션 계층의 제일 앞에 둬서 서버로 들어오는 모든 요청을
먼저 받아서 처리하게 만든다.
      
#### DispatcherServlet에서 컨트롤러로 HTTP요청 위임
컨트롤러를 선정하는 것은 DispatcherServlet의 핸들러 매핑 전략을 이용한다.
스프링에서는 컨트롤러를 핸들러라고도 부른다. (웹의 요청을 다루는 handle 오브젝트라는 의미)

## 3.2 스프링 웹 애플리케이션 환경구성
### 3.2.1 간단한 스프링 웹 프로젝트 생성
### 3.2.2 스프링 웹 학습 테스트
서블릿을 직접 테스트할 때 사용할 수 있는 각종 서블릿 기술의 오브젝트들을 손쉽게 만들 수 있는 방법을 제공해준다.
- MockHttpServletRequest
- MockHttpServletResponse
- MockHttpSession
- MockServletContext
- MockServletConfig

## 3.3 컨트롤러
### 3.3.1 컨트롤러의 종류와 핸들러 어댑터
### 3.3.2 핸들러 매핑
### 3.3.3 핸들러 인터셉터
#### `HandlerInterceptor`  
핸들러 인터셉터는 HandlerInterceptor 인터페이스를 구현해서 만든다.

#### `boolean preHandle(...) throws Exception`
preHandler() 메소드는 컨트롤러가 호출되기 전에 실행된다.
리턴갑이 true 이면 핸들러 실행 체인의 다음 단계로 진행되지만 ,
false 라면 작업을 중단하고 리턴하므로 컨트롤러와 남은 인터셉터들은 실행되지 않는다.

#### `void postHandle(...) throws Exception`
postHandle() 메소드는 컨트롤러를 실행하고 난 후에 호출된다.
컨트롤러가 돌려준 ModelAndView 타입의 정보가 제공되서 컨트롤러 작업 결과를 참조하거나 조작할 수 있다.

#### `void afterCompletion(...) throws Exception`
모든 뷰에서 최종 결과를 생성하는 일을 포함한 모든 작업이 다 완료된 후에 실행된다.
요청 처리중에 사용한 리소스를 반환해 주기에 적당한 메소드다.

핸들러 인터셉터는 하나 이상을 등록할 수 있다. preHandle()은 인터셉터가 등록된 순서대로 실행된다. 반면 postHandle()과 afterCompletion()은 preHandle()이 실행된 순서와 반대로 실행된다.

서블릿 필터는 web.xml에 별도로 등록해줘야 하고 필터 자체는 스프링의 빈이 아니다. 
반면에 웹 애플리케이션으로 들어오는 모든 요청에 적용된다는 장점이 있다.

핸들러 인터셉터는 그 적용대상이 DispatcherServlet의 특정 핸들러 매핑으로 제한 된다는 제약이 있지만, 
인터셉터를 스프링의 빈으로 등록할 수 있고, 컨트롤러 오브젝트에 접근 가능하며,  
ModelAndView와 같은 컨트롤러가 리턴하는 정보를 활용할 수 있다는 등의 장점이 있다.

### 3.3.4 컨트롤러 확장

## 3.4 뷰
### 3.4.1 뷰
### 3.4.2  뷰 리졸버
뷰 리졸버는 핸들러 매핑이 URL로부터 컨트롤러를 찾아주는 것처럼, 
뷰 이름으로부터 사용할 뷰 오브젝트를 찾아준다. 디폴트 InternalResourceViewResolver

## 3.5 기타전략
### 3.5.1 핸들러 예외 리졸버
### 3.5.2 지역정보 리졸버
### 3.5.3 멀티파트 리졸버
DispathcerServlet은 클라이언트로부터 멀티파트 요청을 받으면 멀티파트 
리졸버에게요청해서 HttpServletRequest의 확장 타입인 MultipartHttpServletRequest 오브젝트로 전환한다.

## 3.6 스프링 3.1의 MVC
### 3.6.1 플래시 맵 매니저 전략
### 3.6.2 WebApplicationInitailizer를 이용한 컨텍스트 등록
스프링 3.1에서는 ServletContainerInitailizer를 이용하면 스프링 컨텍스트 설정과 등록 작업에 자바 코드를 이용할 수 있다.
WebApplicationInitailizer를 구현한 클래스를 만들어두면 웹 애플리케이션이 시작될때 onStartup() 메소드가 자동으로 실행된다.
이방법을 이용하면 기존에 web.xml 내에 `<listener>`나 `<servlet>`을 이용해 등록했던 루트 컨텍스트나 서블릿 컨텍스트를 자바 코드에서 직접 등록하고 생성할 수 있다.

원래 리스너는 서블릿 컨텍스트가 생성하는 이벤트를 전달받도록 만들어진 것이다.
초기화 이벤트와 종료이벤트 , 웹 애플리케이션이 시작되고 종료되는 시점에 이벤트가 발생하고, 리스너를 만들어두면 이 두가지 이벤트를 전달받게 된다.

## 3.7 정리
- 스프링 애플리케이션의 웹 계층에는 스프링 MVC와 스프링 포트폴리오의 웹 기술 그리고 서드파티 웹 프레임워크를 모두 사용할 수 있다. 
- 이를 위해 웹 계층과 나머지 계층 간의 의존관계를 제거하고 독립적으로 개발할 수 있어야 한다.
- 핸들러 매핑은 다양한 전략을 통해 요청정보와 이를 처리하는 컨트롤러를 연결해준다.
- 핸들러 인터셉터는 컨트롤러를 실행하기 전후에 적용할 부가기능을 만들 때 사용한다.
- 뷰리졸버는 컨트롤러가 리턴한 논리적인 뷰 이름을 이용해 뷰 오브젝트를 찾아준다.
- 핸들러 예외 리졸버를 이용하면 애플리케이션에서 발생한 예외를 처리하는 방법을 지정해줄 수 있다.