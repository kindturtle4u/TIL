> 출처 : 토비의 스프링 3.1 Vol.1 읽으면서 정리

# 2장 테스트
## 2.1 UserDaoTest 다시보기
### 2.1.1 테스트의 유용성
작은 단위의 테스트  
테스트하고자 하는 대상이 명확하다면 그 대상에만 집중해서 테스트하는 것이 바람직한다.

### 2.1.2 UserDaoTest의 특징
### 2.1.3 UserDaoTest의 문제점
수동 확인 작업의 번거로움
실행 작업의 번거로움

## 2.2 UserDaoTest 개선
### 2.2.1 테스트 검증의 자동화
### 2.2.2 테스트의 효율적인 수행과 결과관리
JUnit 테스트로 전환
```java
public class UserDaoTest {
  
  @Test 
  public void andAndGet() throws SQLException {
    ApplicationContext context = new GenericXmlApplicationContext("applicationContext.xml");
    UserDao dao = context.getBean("userDao", UserDao.class);
    ....
  }
}
```

## 2.3 개발자를 위한 테스팅 프레임워크 JUnit
테스트 없이는 스프링도 의미 없다.

### 2.3.1 JUnit 테스트 실행방법
### 2.3.2 테스트 결과의 일관성
### 2.3.3 포괄적인 테스트
스프링의 창시자인 로드존슨은 "항상 네거티브 테스트를 먼저 만들라" 조언

### 2.3.4 테스트가 이끄는 개발
테스트를 먼저 만들어 테스트가 실패하는 것을 보고 나서 UserDao의 코드에 손을 대기 시작
테스트할 코드도 안만들어놓고 테스트 코드부터 만드는것

테스트 주도 개발 (`TDD , Test Driven Development`) : 테스트 코드를 먼저 만들고, 테스트를 성공하게 해주는 코드를 작성하는 방식의 개발 방법

### 2.3.5 테스트 코드 개선
@Before -> JUnit이 제공하는 애노테이션. @Test 메소드가 실행되기전에 먼저 실행되야 하는 메소드를 정의한다.

JUnit은 테스트 메소드를 실행 할때마다 테스트 클래스의 오브젝트를 새로 만듬  
각 테스트가 서로 영향을 주지 않고 독립적으로 실행됨을 확실히 보장해주기 위해서 매번 새로운 오브젝트를 만듬

픽스처  
테스트를 수행하는데 필요한 정보나 오브젝트를 픽스처(fixture)라고 한다.
일반적으로 픽스처는 여러 테스트에서 반복적으로 사용되기 때문에 @Before 메소드를 이용해 생성해 두면 편리

## 2.4 스프링 테스트 적용
@BeforeClass 스태틱 메소드 (테스트 클래스 전체에 걸쳐 딱 한번만 실행)

### 2.4.1 테스트를 위한 애플리케이션 컨텍스트 관리
스프링 테스트 컨텍스트 프레임워크 적용  
@RunWith(SpringJUnit4ClassRunner.class)  
JUnit 프레임워크의 테스트 실행 방법을 확장할 때 사용하는 애노테이션이다.
SpringJUnit4ClassRunner 라는 JUnit용 테스트 컨텍스트 프레임워크 확장 클래스를 지정해주면 
JUnit이 테스트를 진행하는 중에 테스트가 사용할 애플리케이션 컨텍스트를 만들고 관리하는 작업을 진행해준다.

@ContextConfiguration(locations="/applicationContext.xml")  
자동으로 만들어줄 애플리케이션 컨텍스트의 설정파일 위치를 지정한 것이다.
      
테스트 메소드의 컨텍스트 공유  
JUnit 확장기능은 테스트가 실행되기전에 딱 한번만 애플리케이션 컨텍스트를 만들어 두고,
테스트 오브젝트가 만들어질 때 마다 특별한 방법을 이용해 애플리케이션 컨텍스트를 자신의 테스트 오브젝트의 특정 필드에 주입하는 것이다.

테스트 클래스의 컨텍스트 공유  
여러개의 테스트 클래스가 있는데 모두 같은 설정파일을 가진 어플리케이션 컨텍스트를 사용한다면, 스프링은 테스트 클래스 사이에서도 애플리케이션 컨텍스트를 공유하게 해준다.

@Autowired   
변수타입과 일치하는 컨텍스트 내의 빈을 찾는다. 타입이 일치하는 빈이 있으면 인스턴스 변수에 주입해준다.
자동와이어링이라고 한다.

### 2.4.2 DI와 테스트
인터페이스를 두고 DI를 적용해야한다.  
첫째 , 소프트웨어 개발에서 절대로 바뀌지 않는 것은 없기 때문이다.
       변경이 필요한 상황이 닥쳤을 때 수정에 들어가는 시간과 비용의 부담을 줄요 줄 수 있다.  
둘째 , 다른 차원의 서비스 기능을 도입할수 있기 때문이다.
       ex DB 커넷션의 개수를 카운팅하는 부가기능, AOP   
셋째 , 테스트 때문이다.DI는 테스트가 작은 단위의 대상에 대해 독립적으로 만들어지고 실행되게 하는데 중요한 역할을 한다.
      
@DirtiesContext
테스트 메소드에서 애플리케이션 컨텍스트의 구성이나 상태를 변경 한다는 것을 테스트 컨텍스트 프레임워크에 알려준다.
테스트에서 빈의 의존관계를 강제로 DI하는 방법을 사용했을때 문제는 피할 수 있다.

## 2.5 학습 테스트로 배우는 스프링
일반적으로 애플리케이션 개발자는 자신이 만들고 있는 코드에 대한 테스트만 작성하면된다.
하지만 때로는 자신이 만들지 않은 프레임워크나 다른 개발팀에서 만들어서 제공한 라이브러리 등에 대해서도
테스트를 작성해야한다. 이런 테스트를 학습 테스트(learning test)라고 한다.

### 2.5.1 학습테스트의 장점
### 2.5.2 학습테스트 예제

## 2.6 정리
테스트 하기 쉬운 코드가 좋은 코드다.
테스트 코드도 애필리케이션 코드와 마찬가지로 적절한 리팩토링이 필요하다.