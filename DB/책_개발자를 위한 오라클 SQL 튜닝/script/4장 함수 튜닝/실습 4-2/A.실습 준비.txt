CREATE TABLE TB_SALE_MONTH
(
	AGENT_NO VARCHAR2(4),
	YYYYMM VARCHAR2(6),
	SALE_AMT NUMBER(9)
);

ALTER TABLE TB_SALE_MONTH NOLOGGING;

INSERT /*+ APPEND */  INTO TB_SALE_MONTH -- APPEND ÈùÆ® »ç¿ë
SELECT
 LPAD(TO_CHAR(B.LV), 4, '0'),
 A.YYYYMM,
 TRUNC(DBMS_RANDOM.VALUE(100000, 10000000), -3)
FROM
(
SELECT
	TO_CHAR(ADD_MONTHS(SYSDATE, -ROWNUM+1), 'YYYYMM') YYYYMM
FROM DUAL CONNECT BY LEVEL <= 120
) A, ( SELECT LEVEL LV FROM DUAL CONNECT BY LEVEL <= 9999) B;

COMMIT;


ALTER TABLE TB_SALE_MONTH
ADD CONSTRAINT TB_SALE_MONTH_PK
PRIMARY KEY (AGENT_NO, YYYYMM);

ANALYZE TABLE TB_SALE_MONTH COMPUTE STATISTICS 
FOR TABLE FOR ALL INDEXES FOR ALL INDEXED COLUMNS SIZE 254;

