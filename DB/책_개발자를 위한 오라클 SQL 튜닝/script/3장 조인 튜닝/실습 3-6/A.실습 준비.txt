CREATE TABLE TB_TRD_DAY
(
    TRD_DT VARCHAR2(8), --거래일자
    INSU_CD    VARCHAR2(4), --인수코드
    INSU_DETAIL_CD VARCHAR2(6), --인수상세코드
    TRD_CNT    NUMBER, --거래건수
    CNCL_CNT NUMBER, --취소건수
    EXPORTER_NO    VARCHAR2(10) --수출자번호
);

CREATE TABLE TB_EXPORTER
(
    EXPORTER_NO    VARCHAR2(10), --수출자번호
    EXPORTER_NM VARCHAR2(50) --수출자명
);

INSERT INTO TB_EXPORTER
SELECT
LPAD(TO_CHAR(ROWNUM), 10, '0'),
DBMS_RANDOM.STRING('U', 50)
FROM DUAL CONNECT BY LEVEL <= 100000;

COMMIT;

ALTER TABLE TB_TRD_DAY NOLOGGING;

INSERT /*+ APPEND */ INTO TB_TRD_DAY A -- APPEND 힌트 사용
SELECT
TO_CHAR(SYSDATE - TRUNC(DBMS_RANDOM.VALUE(0, 3650)), 'YYYYMMDD'),
LPAD(TO_CHAR(TRUNC(DBMS_RANDOM.VALUE(1, 9999))), 4, '0'),
LPAD(TO_CHAR(ROWNUM), 6, '0'),
TRUNC(DBMS_RANDOM.VALUE(1, 999)),
TRUNC(DBMS_RANDOM.VALUE(1, 999)),
B.EXPORTER_NO
FROM TB_EXPORTER B ,(SELECT LEVEL LV FROM DUAL CONNECT BY LEVEL <= 10);

COMMIT;

ALTER TABLE TB_TRD_DAY
ADD CONSTRAINT TB_TRD_DAY_PK
PRIMARY KEY (TRD_DT, INSU_CD, INSU_DETAIL_CD);

ALTER TABLE TB_EXPORTER
ADD CONSTRAINT TB_EXPORTER_PK 
PRIMARY KEY (EXPORTER_NO);

ANALYZE TABLE TB_EXPORTER COMPUTE STATISTICS
FOR TABLE FOR ALL INDEXES FOR ALL INDEXED COLUMNS SIZE 254;

ANALYZE TABLE TB_TRD_DAY COMPUTE STATISTICS
FOR TABLE FOR ALL INDEXES FOR ALL INDEXED COLUMNS SIZE 254;



