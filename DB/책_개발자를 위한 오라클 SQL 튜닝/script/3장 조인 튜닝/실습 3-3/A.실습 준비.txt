CREATE TABLE TB_PRDT
(
	PRDT_CD VARCHAR2(6), --상품코드
	PRDT_NM VARCHAR2(50), --상품명
	INST_DTM DATE, --입력일시
	INST_ID VARCHAR2(50) --입력자
);

CREATE TABLE TB_PRDT_SALE_DAY
(
	SALE_NO VARCHAR2(10), --판매번호
	SALE_DT VARCHAR2(8), --판매일자
	SALE_TM VARCHAR2(6), --판매시간
	SALE_CNT NUMBER(9), --판매수
	SALE_AMT NUMBER(9), --판매금액
	PRDT_CD VARCHAR2(6), --제품코드
	INST_DTM DATE, --입력일시
	INST_ID VARCHAR2(50) --입력자
);


INSERT INTO TB_PRDT
SELECT
	LPAD(TO_CHAR(ROWNUM), 6, '0'),
	DBMS_RANDOM.STRING('U', 50),
	SYSDATE,
	'DBMSEXPERT'
FROM DUAL CONNECT BY LEVEL <= 100000;

COMMIT;

ALTER TABLE TB_PRDT_SALE_DAY NOLOGGING;

INSERT /*+ APPEND */  INTO TB_PRDT_SALE_DAY --APPEND 힌트 사용
SELECT
	LPAD(TO_CHAR(ROWNUM), 10, '0'),
	TO_CHAR(SYSDATE - DBMS_RANDOM.VALUE(1, 3650), 'YYYYMMDD'),
  TO_CHAR(SYSDATE - (DBMS_RANDOM.VALUE(1, 86400) / 24 / 60 / 60), 'HH24MISS'),
  TRUNC(DBMS_RANDOM.VALUE(1, 10)),
  TRUNC(DBMS_RANDOM.VALUE(1000, 100000), -3),
  PRDT_CD,
  	SYSDATE,
	'DBMSEXPERT'
FROM TB_PRDT, (SELECT DUMMY FROM DUAL CONNECT BY LEVEL <= 10);

COMMIT;

ALTER TABLE TB_PRDT
ADD CONSTRAINT TB_PRDT_PK
PRIMARY KEY (PRDT_CD);

ALTER TABLE TB_PRDT_SALE_DAY
ADD CONSTRAINT TB_PRDT_SALE_DAY_PK
PRIMARY KEY (SALE_NO);

ALTER TABLE TB_PRDT_SALE_DAY
ADD CONSTRAINT TB_PRDT_SALE_DAY_FK
FOREIGN KEY (PRDT_CD) REFERENCES TB_PRDT(PRDT_CD);

ANALYZE TABLE TB_PRDT COMPUTE STATISTICS 
FOR TABLE FOR ALL INDEXES FOR ALL INDEXED COLUMNS SIZE 254;

ANALYZE TABLE TB_PRDT_SALE_DAY COMPUTE STATISTICS 
FOR TABLE FOR ALL INDEXES FOR ALL INDEXED COLUMNS SIZE 254;

