> 출처 :  리눅스마스터 2급 한권으로 끝내기 읽으면서 정리 

# 6. 프로세스 관리
## 6.1 프로세스의 개념 및 유형
### 6.1.1 프로세스
- 중앙처리장치(CPU)를 할당받아 실행중인 프로그램이다.
- 프로세서가 할당되는 실체로서, 디스패치가 가능한 단위이다.
- 비동기적 행위를 일으키는 주체다.
- 프로세스마다 고유의 프로세스ID(PID)를 가진다.
- 최상위 프로세스는 'systemd'이며 가장 먼저 실행되는 프로세스로 'PID'는 1이다.

### 6.1.2 프로세스 유형
#### 포어 그라운드(foreground)와 백그라운드(background) 프로세스
#### fork()와 exec()
- `fork()`나 `exec()` 모드 한 프로세스가 다른 프로세스를 실행시키기 위해 사용하는 시스템 호출한다.
- `fork()`
  * 새로운 프로세스를 위한 메모리를 할당하고, 기존 프로세스를 복제하는 방식
  * 프로세스가 하나 더 생성되고, 프로세스 ID도 다른 프로세스가 생성되는 방식
  * 원본 프로세스를 부모 프로세스라고 함
  * 복제된 프로세스를 자식 프로세스라고 함
- `exec()`
  * 새로운 프로세스를 위한 메모리를 할당하지 않고, `exec()`를 호출한 프로세스가 아닌 `exec()`에 의해 호출된 프로세스만 메모리에 남게됨
  * `exec()`실행 결과로 생성되는 새로운 프로세스는 없음
  * `exec()`를 호출한 프로세스의 PID가 그대로 새로운 프로세스에 적용되며 `exec()`를 호출한 프로세스는 새로운 프로세스에 의해 덮어쓰게 됨

#### 데몬(Daemon)
- 리눅스 시스템 부팅 시 실행되는 백그라운드 프로세스 이다.
- 사용자의 요청을 기다리고 있다가 요청이 오면 적절히 대응하는 프로세스이다.
- 특징
  * 독립적으로 수행되며, 서비스 요청에 응답하기 위해 항상 메모리에 상주한다.
  * 대부분 데몬 프로그램은 'd'가 붙는다.( 예 httpd, ftpd, mysqld 등).
- 동작방식
  * standalone
    + 부하가 적음
    + 실행 스크립트 경로: `/etc/init.d`
    + 관련 서비스: http, dns, mysql
  * (x)inetd
    + 부하 많음
    + 간헐적인 서비스를 필요로 하는 경우에 이용
    + 다른 데몬들의 상위 데몬(슈퍼데몬)
    + (x)inetd 유형의 데몬들은 독립적으로 동작하지 못하고 (x)inetd 데몬에 의해 활성화댐
    + 실행 스크립터 경로: `/etc/xinetd.d`
    + 관련 서비스: Telnet, FTP
    
#### 시그널(Signal)
- 운영체제에서 사용하는 제한된 형태의 프로세스 간 통신이다.
- 특정 이벤트가 발생했을 경우 프로세스에 전달하는 신호이다.
- 특정 프로세스가 다른 프로세스에 메시지를 보낼 때 사용한다.
- 종류
  * 1 SIGHUP: 터미널과 연결이 끊어졌을 때
  * 2 SIGINT: 키보드로 오는 인터럽트 시그널 Ctrl + c
  * 3 SIGQUIT: 키보드로부터 오는 실행 중지 시그널 Ctrl + \
  * 6 SIGABRT: 비정상 종료(abort 함수에 의해 발생)
  * 9 SIGKILL: 강제 종료 시
  * 14 SIGALRM: 알람에 의해 발생
  * 15 SIGTERM: kill 시스템 호출시
  * 18 SIGCONT: 중지된 프로세스 재실행 시
  * 19 SIGSTOP: SIGCONT 시그널을 받을 때까지 프로세스 중지
  * 20 SIGTSTP: 실행 정지 후 다시 실행을 계속하기 위해 대기 시키는 시그널(Ctrl + z)

## 6.2 프로세스 관리 유틸리티
### 6.2.1 프로세스 관련 명령어
#### ps
- 현재 실행 중인 프로세스의 상태를 출력하는 명령어이다.
- 기본형식: `ps [옵션]`
  * `-a`: 로그인 셸과 터미널에 종속되지 않은 모든 프로세스 출력
  * `-e`: 커널 프로세스를 제외한 모든 프로세스 출력
  * `-f`: 풀(full) 포멧으로 출력
  * `-l`: 자세한 프로세스 목록 출력
  * `-o`: 출력 포멧을 지정(pid, tty, time, command 등)
  * `-p`: 특정 PID를 지정
  * `-r`: 현재 실행 중인 프로세스 출력
  * `-u`: 특정 사용자의 프로세스를 확인할 때 사용 (사용자를 지정하지 않으면 현재 사용자 기준)
  * `-x`: 접속된 터미널 뿐만 아니라 사용중인 모든 프로세스 출력
- 활용 `ps aux`
  * `USER`: 프로세스 소유자명
  * `PID`: 프로세스 식별번호
  * `%CPU`: CPU 사용률
  * `%MEM`: 메모리 사용률
  * `VSZ`: 가상 메모리 사용량
  * `RSS`: 실제 메모리 사용량
  * `TTY`: 프로세스와 연결된 터미널
  * `STAT`: 현재 프로세스 상태
    + `D`: 입출력 작업이 끝나기를 기다리는 정지 상태
    + `P`: 수행가능, 수행 중인 상태
    + `R`: 현재 실행상태
    + `S`: 잠든상태
    + `T`: 정지 상태(suspend), 일시정지 상태
    + `Z`: 좀비(zombie) 프로세스, 작업종료 후 부모 프로세스로부터 회수되지 않아 아직 메모리에 적재되어있는 상태
  * `START`: 프로세스 시작 시간
  * `TIME`: 총 CPU 사용 시간
  * `COMMAND`: 실행 명령

#### pstree
- 실행 중인 프로세스를 트리(tree) 구조로 출력하는 명령어이다.
- 기본 형식: `pstree [옵션] [PID/user]`

#### top
- 프로세스의 상태를 실시간으로 확인하거나, 모니터링하는 명령어이다.
- 시스템 상태(CPU, Memory, Process)를 전반적으로 빠르게 파악할 수 있다.
- 옵션 없이 입력하면 Interval 간격(기본 3초)으로 화면을 갱신하여 정보를 출력한다.
- 기본형식: `top [옵션] [PID]`

#### nohup
- 프로세스를 중단하지 않고, 백그라운드(background) 작업을 수행할 수 있게 하는 명령어이다.
- 사용자가 터미널을 종료해도 프로세스는 백그라운드(background)로 계속 실행한다.
- 'nohup' 명령어로 프로그램을 실행시키면 'nohup.log'라는 로그 파일을 생성한다.
- 기본형식: `nohup [실행파일] &`
- 로그안남기기" `nohup [실행파일] 1>/dev/null 2>&1 &`
- 종료하기: 해당 프로세스를 찾아서 kill 명령어로 종료시킴
```shell
ps -aux | grep [실행파일]
kill -9 [PID]
```

#### jobs
- 백그라운드로 실행 중인 프로세스를 확인하는 명령어이다.
- 기본형식 :`jobs [옵션] [작업번호]`

#### fg, bg
- 프로그램을 포어그라운드(foreground)와 백그라운드(background)로 실행하는 명령어이다.
- 포어그라운드(foreground)에서 백그라운드(background) 작업으로 전환할 수 있다.
  * 실행 중인 작업을 일시 중지(Ctrl + Z)하고, bg명령을 실행한다.
  * 프로그램을 백그라운드로 실행하고자 하면 명령어 뒤에 &를 붙이면 된다.
- 백그라운드에서 포어그라운드 작업으로 전환할 수 있다.
  * 'fg' 명령을 실행하여 포그라운드 작업으로 전환할 수 있다.
  * 포그라운드 작업을 종료하려면 ctrl+c 키를 입력한다.
- 기본형식: `fg %[작업번호], bg %[작업번호]`

#### nice
- 실행할 프로그램의 우선순위를 지정하고, 우선순위 설정값을 확인하는 명령어이다.
- 'nice'값을 지정하여 프로세스의 우선순위를 부여한다.
- 기본 'nice' 값은 보통 '0', 조정 범위는 '-20~19'까지 가능하며, 수치가 낮을수록 우선순위가 높다.
- 일반 사용자는 'nice' 값을 증가만 할 수 있다.
- 기본형식: `nice [옵션] [설정값] [실행 프로그램명]`

#### renice
- 이미 실행 중인 프로세스의 우선순위('nice'값)를 변경하는 명령어이다.
- 기본의 'nice' 값과 상관없이 지정한 'nice' 값을 바로 적용한다.
- 'root' 사용자와 해당 프로세스 소유자만이 변경가능하다.
- 일반 사용자는 'nice'값을 증가만 할 수 있다.
- 기본형식: `renice [옵션] [설정값] [PID]`

#### kill
- 프로세스에 특정한 시그널(Signal)을 보내는 명령어이다.
- 일반적으로 종료되지 않은 프로세스를 종료할 경우에 많이 사용한다.
- 기본형식: `kill [옵션] [PID]`

#### killall
- 프로세스 번호가 아닌 프로세스 명으로 종료시키는 명령어이다.
- 여러 프로세스를 한 번에 종료시키고자 할 때 사용하는 명령어이다.
- 기본형식: `killall [옵션] [프로세스명]`

### 6.2.2 작업스케쥴링
#### cron
- 주기적으로 반복되는 작업을 자동적으로 실행하는 프로그램이다.
- 데몬은 'crond'이며, 관련파일은 '/etc/crontab'이다.
- 기본형식: `crontab [옵션]`
- 옵션
  * `-e`: crontab을 설정하거나 변경
  * `-l`: crontab 설정 내용 출력
  * `-r`: crontab 설정 내용 제거
  * `-u`: 특정 사용자의 작업 스케쥴 수정
- 설정형식 `분 시 일 월 요일(0일요일 ~ 6토요일) 실행명령어`
- 활용
  * /home/cron.sh 파일을 일요일 오전 2시 30분에 실행: `30 2 * * 0 /home/cron.sh`
  * /home/cron.sh 파일을 토요일과 일요일 오전 2시 30분과 6시 30분에 실행 `30 2,6 * * 6,0 /home/cron.sh`
