> 출처 :  리눅스마스터 2급 한권으로 끝내기 읽으면서 정리 

# 3. 기본 명령어
## 3.1 사용자 생성 및 계정 관리
### 3.1.1 사용자 관련 명령어
#### useradd
- 사용자 계정을 생성하는 명령어이다.
- 생성된 사용자 계정 정보는 '/etc/passwd', '/etc/shadow', '/etc/group' 파일에 저장된다.
- `useradd [옵션] [계정명]`
- 옵션
  * `-c`: 사용자 계정에 설명 추가
  * `-d`: 사용자 계정의 홈디렉터리 지정
  * `-e`: 사용자 계정의 유효 기간 설정
  * `-f`: 패스워드가 만료된 후 계정의 만료 날짜 지정
  * `-G`: 사용자 계정의 새로운 그룹 추가
  * `-s`: 사용자 계정의 로그인 기본 셸 지정
- 활용: 'test'계정에 'linux'라는 설명을 추가하여 사용자 생성
```shell
$ useradd -c linux test
$ tail -2 /etc/passwd
```
- passwd
  * 사용자 계정의 패스워드 변경 및 관리하는 명령어이다
  * 생성된 패스워드의 정보는 암호화되어 '/etc/shadow' 파일에 저장된다.

- 패스워드 변경: `passwd [계정명]`
- 'test' 사용자의 패스워드를 '1234'로 변경
```shell
# passwd test
New password: 1234 # 실제에서는 패스워드가 출력되지 않음
Retype: 1234 # 실제에서는 패스워드가 출력되지 않음
```
- 패스워드 관리 `passwd [옵션] [계정명]`
- 옵션
  * `-d`: 사용자 계정의 패스워드 삭제
  * `-l`: 사용자 계정을 잠금(lock) - 해당 계정으로 로그인 불가
  * `-S`: 계정 상태 출력
    + `PS`: 정상
    + `NP`: 패스워드가 설정 안됨
    + `LK`: 잠금(lock) 상태이거나 NP 상태
  * `-u`: 잠금(lock) 상태의 사용자 계정을 해제(unlock) - 해당 계정으로 로그인 가능
- 활용
```shell
$ passwd -S test
test PS 2020-12-31 0 99999 7 -1(비밀번호 설정, SHA512 암호화.)
$ passwd -l test
test 사용자의 비밀번호 잠금
passwd: 성공
$ passwd -S
test LK 1969-12-31 99999 7 -1 (비밀번호 잠금.)
$ passwd -u test
test 사용자의 비밀번호 잠금 해제 중
passwd: 성공
$ passwd -S
test PS 1969-12-31 0 99999 7 -1 (비밀번호 설정, SHA512 암호화.)
```
- su: 'Switch User(또는 Substitue User)'의 약어로 현재 사용자 계정에서 로그아웃하지 않고, 다른 사용자로 전환하는 명령어이다.
- 기본형식: `su [옵션] [사용자] [셸 변수]`
- 옵션
  * `-`, `-l`, `--login`: 사용자의 환경변수를 적용하여 로그인
  * `-c`: 셸을 실행하지 않고 주어진 명령어 실행
  * `-s`: 지정된 셸로 로그인
- 활용
```shell
# 환경변수를 적용하지 않고 'root' 사용자로 전환
$ su root
암호:
$ pwd
/home/test
```
```shell
# 환경변수를 적용하고 'root' 사용자로 전환
$ su - root
암호:
$ pwd
/root
```

### 3.1.2 사용자 관련 파일
- `/etc/default/useradd` 파일
  * 사용자 계정 생성 시 가장 먼저 참조하는 파일이다.
  * 'vi' 편집기 또는 'useradd -D' 명령어로 확인 및 변경이 가능하다.
  * 파일내용
```shell
# useradd defaults file
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
```
  * 설정값
    + `GROUP`: 새로 사용자 계정 생성 시 기본적으로 소속될 그룹의 GID 지정
    + `HOME`: 새로 사용자 계정 생성 시 홈 디렉터리 지정
    + `INACTIVE`: 새로 사용자 계정 생성 시 패스워드 사용 기간이 만료된 후 계정이 사용 불가능하게 되는 날짜 지정
    + `EXPIRE`: 새로 사용자 계정 생성 시 패스워드 만료 날짜 지정 `YYYY-MM-DD` 또는 `YYYY/MM/DD`
    + `SHELL`: 새로 사용자 계정 생성 시 기본 셸 지정
    + `SKEL`: 새로 사용자 계정 생성 시 추가되는 홈 디렉터리에 복사할 파일들이 있는 디렉터리의 경로
    + `CREATE_MAIL_SPOOL`: 새로 생성되는 사용자 계정의 메일함 생성 여부 지정

- `/etc/login.defs` 파일: 새로 사용자 계정 생성 시 두번 째로 참조하는 파일로 기본값을 정의하는 파일이다.
  * 설정값
    + `MAIL_DIR`: 메일 디렉터리 지정
    + `PASS_MAX_DAYS`: 패스워드 만료일
    + `PASS_MIN_DAYS`: 패스워드 변경 후 다시 변경할 수 있는 최소 일 수
    + `PASS_MIN_LEN`: 패스워드 최소 길이
    + `PASS_WARN_AGE`: 설정된 일 수가 남았을 때, 패스워드 만료 경고 메시지를 보냄
    + `UID_MIN`: 사용자에게 할당할 수 있는 최소 UID 번호
    + `UID_MAX`: 사용자에게 할당할 수 있는 최대 UID 번호
    + `CREATE_HOME`: 홈 디렉터리 생성 여부
    + `UMASK`: 사용자 계정 생성 시 홈 디렉터리의 UMASK 값을 설정
    + `USERGROUPS_ENAB`: `userdel` 명령 시 그룹도 삭제, 즉 `userdel` 명령어로 사용자가 없는 그룹을 삭제할 것인지 여부
    + `ENCRYPT_METHOD`: 암호화 방법

- `/etc/skel` 디렉터리
  * `/etc/default/useradd` 파일에서'SKEL'의 값은 `/etc/skel` 디렉터리를 의미한다.
  * `useradd` 명령을 사용하면 `/etc/skel` 디렉터리에 있는 파일들이 새롭게 생성되는 사용자의 홈 디렉터리로 복사된다.
 ```shell
$ ls -al /etc/skel
-rw-r--r--.  1 root root   18  9월 30  2021 .bash_logout
-rw-r--r--.  1 root root  141  9월 30  2021 .bash_profile
-rw-r--r--.  1 root root  376  9월 30  2021 .bashrc
```
  * 파일 설명
    + `.bash_logout`: 사용자가 로그아웃하기 바로 직전에 실행하는 프로그램에 관한(Bash)의 지역적인 시스템 설정과 관련된 파일
    + `.bash_profile`: 환경병수와 배시(Bash)가 수행될 때 실행되는 프로그램을 제어하는 지역적인 시스템 설정과 관련된 파일 (시스템에 로그인할때 마다 실행된다.)
    + `.bashrc`: 별칭(alias)과 배시(Bash)가 수행될 때 실행되는 함수를 제어하는 지역적인 시스템 설정과 관련된 파일 (이미 로그인 한 상태에서 새 터미널 창을 열때마다 실행된다.)
- `/etc/passwd` 파일
  * 사용자의 계정 정보를 저장하고 있는 파일로 로그인 시 사용한다.
  * 사용자 계정 UID, GID, 홈 디렉터리 등을 저장하고 있는 파일이다.
  * 7개의 필드로 구성되어 있으며, ':'(colon)으로 구분한다.
```shell
# 파일내용
$ tail -5 /etc/passwd
unbound:x:997:994:Unbound DNS resolver:/etc/unbound:/sbin/nologin
sssd:x:996:993:User for sssd:/:/sbin/nologin
chrony:x:995:992::/var/lib/chrony:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
ec2-user:x:1000:1000:Cloud User:/home/ec2-user:/bin/bash
```
  * 파일구조 : `username : password : uid : gid : comment : homedirectory : shell`
    + `username`: 계정명
    + `password`: 패스워드
    + `UID`: UID
    + `GID`: GID
    + `comment`: 설명
    + `homedirectory`: 홈 디렉터리
    + `shell`: 로그인 셸 종류

- `/etc/shadow` 파일
  * 사용자의 패스워드가 저장되에 있는 파일이다.
  * 사용자의 패스워드가 암호화되어 저장되며 사용자 계정의 유효기간, 만료일 등을 저장하고 있는 파일이다.
  * 9개의 필드로 구성되어 있으며, `:`(colon)으로 구분한다.
```shell
# 파일내용
$ tail -5 /etc/shadow
unbound:!!:19115::::::
sssd:!!:19115::::::
chrony:!!:19115::::::
sshd:!!:19115::::::
ec2-user:!!:19192:0:99999:7:::
```
  * 파일구조 `username(계정명): password(암호화된 패스워드): lastchange(변경 후 지난일수): mindays(변경 최소일): maxdays(최대 유효기간): warndays(만료 경고일): inactive(만료 후 비활성화 기간): expire(계정 만료일): flag(예약)`

### 3.1.3 사용자 계정 관리
#### usermod
- 사용자 계정정보를 변경하는 명령어 이다.
- 사용자의 계정명, UID, GID, 홈 디렉터리 등을 변경하는 명령어이다.
- 옵션
  * `-c`: 설명변경
  * `-d`: 사용자 홈 디렉터리 변경
  * `-e`: 계정 만료일 변경
  * `-f`: 사용자 계정 유효일 지정
  * `-g`: GID 변경
  * `-G`: 지정한 그룹에 사용자 추가
  * `-s`: 로그인 시 사용할 기본 셸 지정
  * `-u`: UID 변경

#### userdel
- 사용자 계정 정보를 삭제하는 명령어이다.
- 옵션 지정 없이 해당 명령어를 실행하면 `/etc/passwd`, `/etc/shadow`, `/etc/group` 파일의 사용자 계정 정보가 삭제된다.
- 기본 형식 `userdel [옵션] [계정명]`
- 옵션
  * `-r`: `/etc/passwd`, `/etc/shadow`, `/etc/group` 파일 정보와 `/var/spool/mail/` 계정 파일과 홈디렉터리의 모든 내용을 삭제
  
### 3.1.4 사용자 정보 조회 명령어
#### users
- 시스템에 로그인한 사용자의 정보를 출력하는 명령어이다.
```shell
$ users
fitech fitech
```

#### w
- 시스템에 로그인한 사용자의 정보를 자세히 출력하는 명령어이다.
```shell
w
 04:52:01 up 836 days, 23 min,  2 users,  load average: 0.00, 0.01, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
fitech   pts/1    222.121.135.133  01:59    2:48m  0.06s  0.06s -bash
fitech   pts/2    121.175.105.229  04:46    1.00s  0.07s  0.01s w
```


#### who
- 시스템에 로그인한 사용자의 정보를 가단히 출력하는 명령어이다.
```shell
$ who
fitech   pts/1        2022-12-05 01:59 (222.121.135.133)
fitech   pts/2        2022-12-05 04:46 (121.175.105.229)
```
- 옵션
  * `-a`: 모든 정보 출력
  * `-H`: 각 필드의 제목과 함께 출력
  * `-u`: 사용자의 Idle Time 확인
  
#### whoami
- 시스템에 로그인한 사용자를 출력하는 명령어이다.
```shell
$ whoami
root
```

#### id
- 시스템에 로그인한 사용자의 UID, GID, GROUP 정보를 출력하는 명령어이다.
```shell
$ id
uid=1000(ec2-user) gid=1000(ec2-user) groups=1000(ec2-user),4(adm),190(systemd-journal) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
```

## 3.2 그룹 생성 및 그룹 관리
### 3.2.1 그룹관리 명령어
#### groupadd
- 그룹 생성 시 사용하는 명령어이다.
- 기본 형식 `groupadd [옵션] [그룹명]`
- 옵션
  * `-g`: GID 지정
  * `-o`: `-g`옵션과 같이 사용되며, GID 중복 허용
  * `-r`: 시스템 그룹 생성 시 사용하며, GID 499번 이하 값 지정
- 활용
```shell
# test2 그룹 생성
$ tail -2 /etc/group
tcpdump:x:72:
test:x:1000:
$ groupadd -g 1004 test2
$ tail -2 /etc/group
test:x:1000:
test2:x:1004:
```

#### groupdel
- 그룹삭제시 사용하는 명령어이다.
- 기본형식 `groupdel [그룹명]`
- 활용
```shell
# test2 그룹 삭제
$ tail -2 /etc/group
test:x:1000:
test2:x:1004:
$ groupdel test2
$ tail -2 /etc/group
tcpdump:x:72:
test:x:1000:
```

#### groupmod
- 그룹 정보 변경 시 사용하는 명령어이다.
- 기본형식: `groupmode [옵션] [그룹명]`
- 옵션
  * `-g`: GID 변경
  * `-n`: 그룹명 변경
- 활용
```shell
# test2 그룹명을 info로 변경
$ groupmod -n test2 info
```

### 3.2.2 그룹 관련 파일
#### `/etc/group` 파일
- 사용자 그룹 정보가 저장되어 있는 파일이다.
- 4개의 필드로 구성되어 있으며 그룹명, GID, 소속된 사용자 등을 저장한다.
- 파일구조 `groupname(그룹명): password(패스워드): gid(GID): members(소속된 사용자)`

#### `/etc/gpasswd` 파일
- 그룹의 패스워드가 암호화되어 저장되어 있는 파일이다.
- 4개의 필드로 구성되어 있으며 그룹명, 패스워드 등을 저장한다.
- 파일구조 `groupname(그룹명): password(패스워드): owner(소유주): members(소속된 사용자)`

### 3.2.3 그룹정보 조회 명령어
#### groups
- 현재 사용자가 속한 그룹정보를 확인하는 명령어이다.
- 기본형식 `$ groups`
- 활용
```shell
# 'root' 사용자가 'root', 'test' 그룹에 소속되어 있는 것을 확인
$ groups
root test
```

## 3.3 디렉터리 및 파일
### 3.3.1 디렉터리 관련 명령어
#### mkdir
